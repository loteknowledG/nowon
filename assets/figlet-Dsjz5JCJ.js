const oe={FULL_WIDTH:0,FITTING:1,SMUSHING:2,CONTROLLED_SMUSHING:3};class fe{constructor(){this.comment="",this.numChars=0,this.options={}}}const P=["1Row","3-D","3D Diagonal","3D-ASCII","3x5","4Max","5 Line Oblique","AMC 3 Line","AMC 3 Liv1","AMC AAA01","AMC Neko","AMC Razor","AMC Razor2","AMC Slash","AMC Slider","AMC Thin","AMC Tubes","AMC Untitled","ANSI Compact","ANSI Regular","ANSI Shadow","ASCII 12","ASCII 9","ASCII New Roman","Acrobatic","Alligator","Alligator2","Alpha","Alphabet","Arrows","Avatar","B1FF","Babyface Lame","Babyface Leet","Banner","Banner3-D","Banner3","Banner4","Barbwire","Basic","Bear","Bell","Benjamin","Big ASCII 12","Big ASCII 9","Big Chief","Big Money-ne","Big Money-nw","Big Money-se","Big Money-sw","Big Mono 12","Big Mono 9","Big","Bigfig","Binary","Block","Blocks","Bloody","BlurVision ASCII","Bolger","Braced","Bright","Broadway KB","Broadway","Bubble","Bulbhead","Caligraphy","Caligraphy2","Calvin S","Cards","Catwalk","Chiseled","Chunky","Circle","Classy","Coder Mini","Coinstak","Cola","Colossal","Computer","Contessa","Contrast","Cosmike","Cosmike2","Crawford","Crawford2","Crazy","Cricket","Cursive","Cyberlarge","Cybermedium","Cybersmall","Cygnet","DANC4","DOS Rebel","DWhistled","Dancing Font","Decimal","Def Leppard","Delta Corps Priest 1","DiamFont","Diamond","Diet Cola","Digital","Doh","Doom","Dot Matrix","Double Shorts","Double","Dr Pepper","Efti Chess","Efti Font","Efti Italic","Efti Piti","Efti Robot","Efti Wall","Efti Water","Electronic","Elite","Emboss 2","Emboss","Epic","Fender","Filter","Fire Font-k","Fire Font-s","Flipped","Flower Power","Font Font","Four Tops","Fraktur","Fun Face","Fun Faces","Future","Fuzzy","Georgi16","Georgia11","Ghost","Ghoulish","Glenyn","Goofy","Gothic","Graceful","Gradient","Graffiti","Greek","Heart Left","Heart Right","Henry 3D","Hex","Hieroglyphs","Hollywood","Horizontal Left","Horizontal Right","ICL-1900","Impossible","Invita","Isometric1","Isometric2","Isometric3","Isometric4","Italic","Ivrit","JS Block Letters","JS Bracket Letters","JS Capital Curves","JS Cursive","JS Stick Letters","Jacky","Jazmine","Jerusalem","Katakana","Kban","Keyboard","Knob","Konto Slant","Konto","LCD","Larry 3D 2","Larry 3D","Lean","Letter","Letters","Lil Devil","Line Blocks","Linux","Lockergnome","Madrid","Marquee","Maxfour","Merlin1","Merlin2","Mike","Mini","Mirror","Mnemonic","Modular","Mono 12","Mono 9","Morse","Morse2","Moscow","Mshebrew210","Muzzle","NScript","NT Greek","NV Script","Nancyj-Fancy","Nancyj-Improved","Nancyj-Underlined","Nancyj","Nipples","O8","OS2","Octal","Ogre","Old Banner","Pagga","Patorjk's Cheese","Patorjk-HeX","Pawp","Peaks Slant","Peaks","Pebbles","Pepper","Poison","Puffy","Puzzle","Pyramid","Rammstein","Rebel","Rectangles","Red Phoenix","Relief","Relief2","Reverse","Roman","Rot13","Rotated","Rounded","Rowan Cap","Rozzo","RubiFont","Runic","Runyc","S Blood","SL Script","Santa Clara","Script","Serifcap","Shaded Blocky","Shadow","Shimrod","Short","Slant Relief","Slant","Slide","Small ASCII 12","Small ASCII 9","Small Block","Small Braille","Small Caps","Small Isometric1","Small Keyboard","Small Mono 12","Small Mono 9","Small Poison","Small Script","Small Shadow","Small Slant","Small Tengwar","Small","Soft","Speed","Spliff","Stacey","Stampate","Stampatello","Standard","Star Strips","Star Wars","Stellar","Stforek","Stick Letters","Stop","Straight","Stronger Than All","Sub-Zero","Swamp Land","Swan","Sweet","THIS","Tanja","Tengwar","Term","Terrace","Test1","The Edge","Thick","Thin","Thorned","Three Point","Ticks Slant","Ticks","Tiles","Tinker-Toy","Tmplr","Tombstone","Train","Trek","Tsalagi","Tubular","Twisted","Two Point","USA Flag","Univers","Upside Down Text","Varsity","Wavescape","Wavy","Weird","Wet Letter","Whimsy","WideTerm","Wow","miniwi"],q={"ANSI-Compact":"ANSI Compact"},D=d=>q[d]?q[d]:d;function he(d){return/[.*+?^${}()|[\]\\]/.test(d)?"\\"+d:d}const ce=(()=>{const{FULL_WIDTH:d=0,FITTING:C,SMUSHING:w,CONTROLLED_SMUSHING:I}=oe,v={},F={font:"Standard",fontPath:"./fonts",fetchFontIfMissing:!0};function _(n,r,e){const t=he(n.trim().slice(-1))||"@",i=r===e-1?new RegExp(t+t+"?\\s*$"):new RegExp(t+"\\s*$");return n.replace(i,"")}function Y(n=-1,r=null){let e={},t,i=[[16384,"vLayout",w],[8192,"vLayout",C],[4096,"vRule5",!0],[2048,"vRule4",!0],[1024,"vRule3",!0],[512,"vRule2",!0],[256,"vRule1",!0],[128,"hLayout",w],[64,"hLayout",C],[32,"hRule6",!0],[16,"hRule5",!0],[8,"hRule4",!0],[4,"hRule3",!0],[2,"hRule2",!0],[1,"hRule1",!0]];t=r!==null?r:n;for(const[l,u,a]of i)t>=l?(t-=l,e[u]===void 0&&(e[u]=a)):u!=="vLayout"&&u!=="hLayout"&&(e[u]=!1);return typeof e.hLayout>"u"?n===0?e.hLayout=C:n===-1?e.hLayout=d:e.hRule1||e.hRule2||e.hRule3||e.hRule4||e.hRule5||e.hRule6?e.hLayout=I:e.hLayout=w:e.hLayout===w&&(e.hRule1||e.hRule2||e.hRule3||e.hRule4||e.hRule5||e.hRule6)&&(e.hLayout=I),typeof e.vLayout>"u"?e.vRule1||e.vRule2||e.vRule3||e.vRule4||e.vRule5?e.vLayout=I:e.vLayout=d:e.vLayout===w&&(e.vRule1||e.vRule2||e.vRule3||e.vRule4||e.vRule5)&&(e.vLayout=I),e}function H(n,r,e=""){return n===r&&n!==e?n:!1}function A(n,r){let e="|/\\[]{}()<>";if(n==="_"){if(e.indexOf(r)!==-1)return r}else if(r==="_"&&e.indexOf(n)!==-1)return n;return!1}function x(n,r){let e="| /\\ [] {} () <>",t=e.indexOf(n),i=e.indexOf(r);if(t!==-1&&i!==-1&&t!==i&&Math.abs(t-i)!==1){const l=Math.max(t,i),u=l+1;return e.substring(l,u)}return!1}function O(n,r){let e="[] {} ()",t=e.indexOf(n),i=e.indexOf(r);return t!==-1&&i!==-1&&Math.abs(t-i)<=1?"|":!1}function j(n,r){return{"/\\":"|","\\/":"Y","><":"X"}[n+r]||!1}function G(n,r,e=""){return n===e&&r===e?e:!1}function $(n,r){return n===r?n:!1}function z(n,r){return A(n,r)}function W(n,r){return x(n,r)}function J(n,r){return n==="-"&&r==="_"||n==="_"&&r==="-"?"=":!1}function U(n,r){return n==="|"&&r==="|"?"|":!1}function M(n,r,e){return r===" "||r===""||r===e&&n!==" "?n:r}function Z(n,r,e){if(e.fittingRules&&e.fittingRules.vLayout===d)return"invalid";let t,i=Math.min(n.length,r.length),l,u,a=!1,s;if(i===0)return"invalid";for(t=0;t<i;t++)if(l=n.substring(t,t+1),u=r.substring(t,t+1),l!==" "&&u!==" "){if(e.fittingRules&&e.fittingRules.vLayout===C)return"invalid";if(e.fittingRules&&e.fittingRules.vLayout===w)return"end";if(U(l,u)){a=a||!1;continue}if(s=!1,s=e.fittingRules&&e.fittingRules.vRule1?$(l,u):s,s=!s&&e.fittingRules&&e.fittingRules.vRule2?z(l,u):s,s=!s&&e.fittingRules&&e.fittingRules.vRule3?W(l,u):s,s=!s&&e.fittingRules&&e.fittingRules.vRule4?J(l,u):s,a=!0,!s)return"invalid"}return a?"end":"valid"}function Q(n,r,e){let t=n.length,i=n.length,l,u,a,s=1,o,h,f;for(;s<=t;){for(l=n.slice(Math.max(0,i-s),i),u=r.slice(0,Math.min(t,s)),a=u.length,f="",o=0;o<a;o++)if(h=Z(l[o],u[o],e),h==="end")f=h;else if(h==="invalid"){f=h;break}else f===""&&(f="valid");if(f==="invalid"){s--;break}if(f==="end")break;f==="valid"&&s++}return Math.min(t,s)}function ee(n,r,e){let t,i=Math.min(n.length,r.length),l,u,a="",s;const o=e.fittingRules||{};for(t=0;t<i;t++)l=n.substring(t,t+1),u=r.substring(t,t+1),l!==" "&&u!==" "?o.vLayout===C||o.vLayout===w?a+=M(l,u):(s=!1,s=o.vRule5?U(l,u):s,s=!s&&o.vRule1?$(l,u):s,s=!s&&o.vRule2?z(l,u):s,s=!s&&o.vRule3?W(l,u):s,s=!s&&o.vRule4?J(l,u):s,a+=s):a+=M(l,u);return a}function te(n,r,e,t){let i=n.length,l=r.length,u=n.slice(0,Math.max(0,i-e)),a=n.slice(Math.max(0,i-e),i),s=r.slice(0,Math.min(e,l)),o,h,f,c=[],g;for(h=a.length,o=0;o<h;o++)o>=l?f=a[o]:f=ee(a[o],s[o],t),c.push(f);return g=r.slice(Math.min(e,l),l),[...u,...c,...g]}function K(n,r){const e=" ".repeat(r);return n.map(t=>t+e)}function ne(n,r,e){let t=n[0].length,i=r[0].length,l;return t>i?r=K(r,t-i):i>t&&(n=K(n,i-t)),l=Q(n,r,e),te(n,r,l,e)}function re(n,r,e){const t=e.fittingRules||{};if(t.hLayout===d)return 0;let i,l=n.length,u=r.length,a=l,s=1,o=!1,h,f,c,g;if(l===0)return 0;e:for(;s<=a;){const L=l-s;for(h=n.substring(L,L+s),f=r.substring(0,Math.min(s,u)),i=0;i<Math.min(s,u);i++)if(c=h.substring(i,i+1),g=f.substring(i,i+1),c!==" "&&g!==" "){if(t.hLayout===C){s=s-1;break e}else if(t.hLayout===w){(c===e.hardBlank||g===e.hardBlank)&&(s=s-1);break e}else if(o=!0,!(t.hRule1&&H(c,g,e.hardBlank)||t.hRule2&&A(c,g)||t.hRule3&&x(c,g)||t.hRule4&&O(c,g)||t.hRule5&&j(c,g)||t.hRule6&&G(c,g,e.hardBlank))){s=s-1;break e}}if(o)break;s++}return Math.min(a,s)}function N(n,r,e,t){let i,l,u=[],a,s,o,h,f,c,g,L;const m=t.fittingRules||{};if(typeof t.height!="number")throw new Error("height is not defined.");for(i=0;i<t.height;i++){g=n[i],L=r[i],f=g.length,c=L.length,a=f-e,s=g.slice(0,Math.max(0,a)),o="";const E=Math.max(0,f-e);let p=g.substring(E,E+e),B=L.substring(0,Math.min(e,c));for(l=0;l<e;l++){let y=l<f?p.substring(l,l+1):" ",S=l<c?B.substring(l,l+1):" ";if(y!==" "&&S!==" ")if(m.hLayout===C||m.hLayout===w)o+=M(y,S,t.hardBlank);else{const se=m.hRule1&&H(y,S,t.hardBlank)||m.hRule2&&A(y,S)||m.hRule3&&x(y,S)||m.hRule4&&O(y,S)||m.hRule5&&j(y,S)||m.hRule6&&G(y,S,t.hardBlank)||M(y,S,t.hardBlank);o+=se}else o+=M(y,S,t.hardBlank)}e>=c?h="":h=L.substring(e,e+Math.max(0,c-e)),u[i]=s+o+h}return u}function b(n){return new Array(n).fill("")}const T=function(n){return Math.max(...n.map(r=>r.length))};function k(n,r,e){return n.reduce(function(t,i){return N(t,i.fig,i.overlap||0,e)},b(r))}function ie(n,r,e){for(let t=n.length-1;t>0;t--){const i=k(n.slice(0,t),r,e);if(T(i)<=e.width)return{outputFigText:i,chars:n.slice(t)}}return{outputFigText:b(r),chars:n}}function le(n,r,e){let t,i,l=0,u,a,s,o=e.height,h=[],f,c={chars:[],overlap:l},g=[],L,m,E,p,B;if(typeof o!="number")throw new Error("height is not defined.");a=b(o);const y=e.fittingRules||{};for(e.printDirection===1&&(n=n.split("").reverse().join("")),s=n.length,t=0;t<s;t++)if(L=n.substring(t,t+1),m=L.match(/\s/),i=r[L.charCodeAt(0)],p=null,i){if(y.hLayout!==d){for(l=1e4,u=0;u<o;u++)l=Math.min(l,re(a[u],i[u],e));l=l===1e4?0:l}if(e.width>0&&(e.whitespaceBreak?(E=k(c.chars.concat([{fig:i,overlap:l}]),o,e),p=k(g.concat([{fig:E,overlap:c.overlap}]),o,e),f=T(p)):(p=N(a,i,l,e),f=T(p)),f>=e.width&&t>0&&(e.whitespaceBreak?(a=k(g.slice(0,-1),o,e),g.length>1&&(h.push(a),a=b(o)),g=[]):(h.push(a),a=b(o)))),e.width>0&&e.whitespaceBreak&&((!m||t===s-1)&&c.chars.push({fig:i,overlap:l}),m||t===s-1)){for(B=null;p=k(c.chars,o,e),f=T(p),f>=e.width;)B=ie(c.chars,o,e),c={chars:B.chars},h.push(B.outputFigText);f>0&&(B?g.push({fig:p,overlap:1}):g.push({fig:p,overlap:c.overlap})),m&&(g.push({fig:i,overlap:l}),a=b(o)),t===s-1&&(a=k(g,o,e)),c={chars:[],overlap:l};continue}a=N(a,i,l,e)}return T(a)>0&&h.push(a),e.showHardBlanks||h.forEach(function(S){for(s=S.length,u=0;u<s;u++)S[u]=S[u].replace(new RegExp("\\"+e.hardBlank,"g")," ")}),n===""&&h.length===0&&h.push(new Array(o).fill("")),h}const ue=function(n,r){let e;const t=r.fittingRules||{};if(n==="default")e={hLayout:t.hLayout,hRule1:t.hRule1,hRule2:t.hRule2,hRule3:t.hRule3,hRule4:t.hRule4,hRule5:t.hRule5,hRule6:t.hRule6};else if(n==="full")e={hLayout:d,hRule1:!1,hRule2:!1,hRule3:!1,hRule4:!1,hRule5:!1,hRule6:!1};else if(n==="fitted")e={hLayout:C,hRule1:!1,hRule2:!1,hRule3:!1,hRule4:!1,hRule5:!1,hRule6:!1};else if(n==="controlled smushing")e={hLayout:I,hRule1:!0,hRule2:!0,hRule3:!0,hRule4:!0,hRule5:!0,hRule6:!0};else if(n==="universal smushing")e={hLayout:w,hRule1:!1,hRule2:!1,hRule3:!1,hRule4:!1,hRule5:!1,hRule6:!1};else return;return e},ae=function(n,r){let e={};const t=r.fittingRules||{};if(n==="default")e={vLayout:t.vLayout,vRule1:t.vRule1,vRule2:t.vRule2,vRule3:t.vRule3,vRule4:t.vRule4,vRule5:t.vRule5};else if(n==="full")e={vLayout:d,vRule1:!1,vRule2:!1,vRule3:!1,vRule4:!1,vRule5:!1};else if(n==="fitted")e={vLayout:C,vRule1:!1,vRule2:!1,vRule3:!1,vRule4:!1,vRule5:!1};else if(n==="controlled smushing")e={vLayout:I,vRule1:!0,vRule2:!0,vRule3:!0,vRule4:!0,vRule5:!0};else if(n==="universal smushing")e={vLayout:w,vRule1:!1,vRule2:!1,vRule3:!1,vRule4:!1,vRule5:!1};else return;return e},V=function(n,r,e){e=e.replace(/\r\n/g,`
`).replace(/\r/g,`
`);const t=D(n);let i=e.split(`
`),l=[],u,a,s;for(a=i.length,u=0;u<a;u++)l=l.concat(le(i[u],v[t],r));for(a=l.length,s=l[0],u=1;u<a;u++)s=ne(s,l[u],r);return s?s.join(`
`):""};function X(n,r){let e;if(typeof structuredClone<"u"?e=structuredClone(n):e=JSON.parse(JSON.stringify(n)),e.showHardBlanks=r.showHardBlanks||!1,e.width=r.width||-1,e.whitespaceBreak=r.whitespaceBreak||!1,r.horizontalLayout){const t=ue(r.horizontalLayout,n);t&&Object.assign(e.fittingRules,t)}if(r.verticalLayout){const t=ae(r.verticalLayout,n);t&&Object.assign(e.fittingRules,t)}return e.printDirection=r.printDirection!==null&&r.printDirection!==void 0?r.printDirection:n.printDirection,e}const R=async function(n,r,e){return R.text(n,r,e)};return R.text=async function(n,r,e){n=n+"";let t,i;typeof r=="function"?(i=r,t={font:F.font}):typeof r=="string"?(t={font:r},i=e):r?(t=r,i=e):(t={font:F.font},i=e);const l=t.font||F.font;try{const u=await R.loadFont(l),a=u?V(l,X(u,t),n):"";return i&&i(null,a),a}catch(u){const a=u instanceof Error?u:new Error(String(u));if(i)return i(a),"";throw a}},R.textSync=function(n,r){n=n+"",typeof r=="string"?r={font:r}:r=r||{};const e=r.font||F.font;let t=X(R.loadFontSync(e),r);return V(e,t,n)},R.metadata=async function(n,r){n=n+"";try{const e=await R.loadFont(n);if(!e)throw new Error("Error loading font.");const t=D(n),i=v[t]||{},l=[e,i.comment||""];return r&&r(null,e,i.comment),l}catch(e){const t=e instanceof Error?e:new Error(String(e));if(r)return r(t),null;throw t}},R.defaults=function(n){return n&&typeof n=="object"&&Object.assign(F,n),typeof structuredClone<"u"?structuredClone(F):JSON.parse(JSON.stringify(F))},R.parseFont=function(n,r,e=!0){if(v[n]&&!e)return v[n].options;r=r.replace(/\r\n/g,`
`).replace(/\r/g,`
`);const t=new fe,i=r.split(`
`),l=i.shift();if(!l)throw new Error("Invalid font file: missing header");const u=l.split(" "),a={hardBlank:u[0].substring(5,6),height:parseInt(u[1],10),baseline:parseInt(u[2],10),maxLength:parseInt(u[3],10),oldLayout:parseInt(u[4],10),numCommentLines:parseInt(u[5],10),printDirection:u[6]?parseInt(u[6],10):0,fullLayout:u[7]?parseInt(u[7],10):null,codeTagCount:u[8]?parseInt(u[8],10):null};if((a.hardBlank||"").length!==1||[a.height,a.baseline,a.maxLength,a.oldLayout,a.numCommentLines].some(h=>h==null||isNaN(h)))throw new Error("FIGlet header contains invalid values.");if(a.height==null||a.numCommentLines==null)throw new Error("FIGlet header contains invalid values.");a.fittingRules=Y(a.oldLayout,a.fullLayout),t.options=a;const o=[];for(let h=32;h<=126;h++)o.push(h);if(o.push(196,214,220,228,246,252,223),i.length<a.numCommentLines+a.height*o.length)throw new Error(`FIGlet file is missing data. Line length: ${i.length}. Comment lines: ${a.numCommentLines}. Height: ${a.height}. Num chars: ${o.length}.`);for(t.comment=i.splice(0,a.numCommentLines).join(`
`),t.numChars=0;i.length>0&&t.numChars<o.length;){const h=o[t.numChars];t[h]=i.splice(0,a.height);for(let f=0;f<a.height;f++)typeof t[h][f]>"u"?t[h][f]="":t[h][f]=_(t[h][f],f,a.height);t.numChars++}for(;i.length>0;){const h=i.shift();if(!h||h.trim()==="")break;let f=h.split(" ")[0],c;if(/^-?0[xX][0-9a-fA-F]+$/.test(f))c=parseInt(f,16);else if(/^-?0[0-7]+$/.test(f))c=parseInt(f,8);else if(/^-?[0-9]+$/.test(f))c=parseInt(f,10);else throw new Error(`Error parsing data. Invalid data: ${f}`);if(c===-1||c<-2147483648||c>2147483647){const g=c===-1?"The char code -1 is not permitted.":`The char code cannot be ${c<-2147483648?"less than -2147483648":"greater than 2147483647"}.`;throw new Error(`Error parsing data. ${g}`)}t[c]=i.splice(0,a.height);for(let g=0;g<a.height;g++)typeof t[c][g]>"u"?t[c][g]="":t[c][g]=_(t[c][g],g,a.height);t.numChars++}return v[n]=t,a},R.loadedFonts=()=>Object.keys(v),R.clearLoadedFonts=()=>{Object.keys(v).forEach(n=>{delete v[n]})},R.loadFont=async function(n,r){const e=D(n);if(v[e]){const t=v[e].options;return r&&r(null,t),Promise.resolve(t)}try{if(!F.fetchFontIfMissing)throw new Error(`Font is not loaded: ${e}`);const t=await fetch(`${F.fontPath}/${e}.flf`);if(!t.ok)throw new Error(`Network response was not ok: ${t.status}`);const i=await t.text(),l=R.parseFont(e,i);return r&&r(null,l),l}catch(t){const i=t instanceof Error?t:new Error(String(t));if(r)return r(i),null;throw i}},R.loadFontSync=function(n){const r=D(n);if(v[r])return v[r].options;throw new Error("Synchronous font loading is not implemented for the browser, it will only work for fonts already loaded.")},R.preloadFonts=async function(n,r){try{for(const e of n){const t=D(e),i=await fetch(`${F.fontPath}/${t}.flf`);if(!i.ok)throw new Error(`Failed to preload fonts. Error fetching font: ${t}, status code: ${i.statusText}`);const l=await i.text();R.parseFont(t,l)}r&&r()}catch(e){const t=e instanceof Error?e:new Error(String(e));if(r){r(t);return}throw e}},R.fonts=function(n){return new Promise(function(r,e){r(P),n&&n(null,P)})},R.fontsSync=function(){return P},R.figFonts=v,R})();export{ce as default};
