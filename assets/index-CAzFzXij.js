import{r,_,j as e}from"./index-BAjzfBM7.js";function G(){const[g,I]=r.useState("nowon"),[c,f]=r.useState(""),[E,C]=r.useState([]),[b,y]=r.useState("Standard"),[x,P]=r.useState(!1),[L,k]=r.useState(!1),[v,T]=r.useState(12),[h,F]=r.useState(!1),[w,S]=r.useState(0),[m,B]=r.useState(()=>{var t;return!!((t=globalThis.localStorage)!=null&&t.getItem("figlet-fonts-preloaded"))}),j=r.useRef(!0);r.useEffect(()=>()=>{j.current=!1},[]),r.useEffect(()=>{(async()=>{try{const t=await _(()=>import("./figlet-Dsjz5JCJ.js"),[]),o=t&&t.default||t,d=`${(()=>{const i="/nowon/tui-ftw/";if(typeof i=="string"&&i!=="/")return i.replace(/\/$/,"");try{const a=new URL(document.baseURI).pathname.split("/").filter(Boolean)[0];return a?`/${a}`:""}catch{return""}})()}/fonts`;try{o.defaults&&o.defaults({fontPath:d,fetchFontIfMissing:!0})}catch{}const p=await new Promise((i,s)=>o.fonts((a,l)=>a?s(a):i(l)));if(!j.current)return;C(p.slice(0,120)),y(i=>i||p[0]||"Standard")}catch{C(["Standard","Slant","Small","Ghost"])}})()},[]);async function R(t=g,o=b){P(!0);try{const n=await _(()=>import("./figlet-Dsjz5JCJ.js"),[]),d=n&&n.default||n,i=`${(()=>{const a="/nowon/tui-ftw/";if(typeof a=="string"&&a!=="/")return a.replace(/\/$/,"");try{const u=new URL(document.baseURI).pathname.split("/").filter(Boolean)[0];return u?`/${u}`:""}catch{return""}})()}/fonts`;try{d.defaults&&d.defaults({fontPath:i,fetchFontIfMissing:!0})}catch{}const s=await new Promise((a,l)=>{d.text(t||" ",{font:o,horizontalLayout:"default"},(u,M)=>u?l(u):a(M))});if(!j.current)return;f(s)}catch(n){const d=String((n==null?void 0:n.message)||String(n));d.includes("FIGlet header contains invalid values")?(f(`figlet error: invalid font header for "${o}" — falling back to "Standard".`),o!=="Standard"&&(y("Standard"),setTimeout(()=>{R(t,"Standard")},60))):f(`figlet error: ${d}`)}finally{P(!1)}}r.useEffect(()=>{const t=setTimeout(()=>{R()},120);return()=>clearTimeout(t)},[g,b]);const N=async()=>{try{await navigator.clipboard.writeText(c),k(!0),setTimeout(()=>k(!1),1200)}catch{}},U=()=>{const t=new Blob([c],{type:"text/plain"}),o=URL.createObjectURL(t),n=document.createElement("a");n.href=o,n.download=`${(g||"figlet").replace(/\s+/g,"_")}.txt`,document.body.appendChild(n),n.click(),n.remove(),URL.revokeObjectURL(o)},z=()=>{window.dispatchEvent(new CustomEvent("nowon:insert-into-clack",{detail:{text:c}}))},A=async()=>{const t="npm run opentui:figlet";try{await navigator.clipboard.writeText(t),f(o=>`${o}

[Native demo command copied to clipboard: ${t}]`)}catch{f(n=>`${n}

Run this in a terminal: ${t}`)}};async function $(t){F(!0),S(0);try{const o=await _(()=>import("./figlet-Dsjz5JCJ.js"),[]),n=o&&o.default||o,p=`${(()=>{const s="/nowon/tui-ftw/";if(typeof s=="string"&&s!=="/")return s.replace(/\/$/,"");try{const l=new URL(document.baseURI).pathname.split("/").filter(Boolean)[0];return l?`/${l}`:""}catch{return""}})()}/fonts`;try{n.defaults&&n.defaults({fontPath:p,fetchFontIfMissing:!0})}catch{}const i=t&&t.length?t:await new Promise((s,a)=>n.fonts((l,u)=>l?a(l):s(u)));for(let s=0;s<i.length;s++){try{await n.loadFont(i[s])}catch{}const a=Math.round((s+1)/i.length*100);S(a)}localStorage.setItem("figlet-fonts-preloaded","1"),B(!0)}catch(o){console.error("preloadFonts error",o)}finally{F(!1),setTimeout(()=>S(0),600)}}function D(){h||$()}return r.useEffect(()=>{if(m)return;const t=setTimeout(async()=>{try{await $(["Standard","Slant","Small","Ghost","Colossal","Banner"])}catch{}},2e3);return()=>clearTimeout(t)},[m]),e.jsxs("div",{style:{padding:16},className:"cli-card",children:[e.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",marginBottom:8},children:[e.jsx("strong",{children:"Figlet generator (client-side)"}),e.jsx("div",{style:{marginLeft:"auto",color:"var(--muted)",fontSize:13},children:x?"Rendering…":"Live preview"})]}),e.jsxs("div",{style:{display:"flex",gap:12,marginBottom:12,alignItems:"stretch"},children:[e.jsx("input",{"aria-label":"Figlet text",value:g,onChange:t=>I(t.target.value),style:{flex:1,padding:"8px 10px",borderRadius:8,border:"1px solid rgba(255,255,255,0.04)",background:"transparent",color:"inherit",fontFamily:"Hack, monospace"}}),e.jsx("select",{value:b,onChange:t=>y(t.target.value),style:{minWidth:160,padding:"8px 10px",borderRadius:8,background:"transparent",border:"1px solid rgba(255,255,255,0.04)",color:"inherit"},children:E.map(t=>e.jsx("option",{value:t,children:t},t))}),e.jsx("button",{className:"btn",onClick:()=>void R(),style:{whiteSpace:"nowrap"},disabled:x,children:x?"Rendering…":"Render"})]}),e.jsxs("div",{style:{display:"flex",gap:12,marginBottom:12,alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx("label",{style:{color:"var(--muted)",fontSize:13,minWidth:36},children:"Size"}),e.jsx("input",{type:"range",min:8,max:40,value:v,onChange:t=>T(Number(t.target.value)),style:{width:140}}),e.jsx("input",{type:"number",value:v,onChange:t=>T(Number(t.target.value||0)),style:{width:64,padding:"6px 8px",borderRadius:6,border:"1px solid rgba(255,255,255,0.04)",background:"transparent",color:"inherit",textAlign:"center"}})]}),e.jsx("button",{className:"btn ghost",onClick:D,disabled:h||m,title:"Preload all FIGlet fonts to avoid any runtime downloads",children:m?"Fonts preloaded":h?`Preloading (${w}%)`:"Preload fonts"}),e.jsx("button",{className:"btn ghost",onClick:()=>void A(),title:"Copy command to run native OpenTUI Figlet demo",children:"Run native demo"}),e.jsx("button",{className:"btn ghost",onClick:N,disabled:!c,children:L?"Copied":"Copy"}),e.jsx("button",{className:"btn ghost",onClick:U,disabled:!c,children:"Download .txt"}),e.jsx("button",{className:"btn ghost",onClick:z,disabled:!c,children:"Insert into REPL"}),e.jsx("button",{className:"btn ghost",onClick:()=>{I(""),f("")},style:{marginLeft:"auto"},children:"Clear"})]}),h&&e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("div",{style:{height:8,background:"rgba(255,255,255,0.03)",borderRadius:6,overflow:"hidden"},children:e.jsx("div",{style:{width:`${w}%`,height:"100%",background:"linear-gradient(90deg,#00e6a8,#7b61ff)"}})}),e.jsxs("div",{style:{color:"var(--muted)",fontSize:12,marginTop:6},children:[w,"% loaded"]})]}),e.jsx("div",{style:{borderRadius:8,padding:12,background:"rgba(0,0,0,0.04)",minHeight:120,whiteSpace:"pre",fontFamily:"'Hack','VT323',monospace",overflow:"auto"},children:e.jsx("pre",{className:"ascii-pre neon",style:{margin:0,whiteSpace:"pre",fontSize:v},children:c||"Type text above to preview Figlet ASCII — choose a font."})}),e.jsxs("div",{style:{marginTop:10,color:"var(--muted)",fontSize:13},children:["Tip: use ",e.jsx("code",{children:"/figlet <text>"})," in the Console demo or press ",e.jsx("strong",{children:"Insert into REPL"})," to paste the ASCII into the Clack console."]})]})}export{G as default};
